<!DOCTYPE html>
<html>
<head>
    <title>Admin Login Test</title>
</head>
<body>
    <h1>Admin Login Test</h1>
    <button onclick="testAdminLogin()">Test Admin Login</button>
    <div id="result"></div>
    
    <script>
        async function testAdminLogin() {
            const result = document.getElementById('result');
            
            try {
                // Clear all cookies
                document.cookie = "forexapp.sid=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";
                document.cookie = "forexsid=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";
                document.cookie = "fxsession=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";
                result.innerHTML += "<p>‚úÖ Cleared all cookies</p>";
                
                // Clear server session
                await fetch("/api/clear-session", { 
                    method: "POST", 
                    credentials: "include" 
                });
                result.innerHTML += "<p>‚úÖ Cleared server session</p>";
                
                // Admin login
                const response = await fetch("/api/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email: "admin@forexsignals.com" }),
                    credentials: "include"
                });
                
                const data = await response.json();
                console.log("Login response:", data);
                
                if (data.user && data.user.isAdmin) {
                    result.innerHTML += "<p>üéâ ADMIN LOGIN SUCCESS!</p>";
                    result.innerHTML += "<p>User: " + JSON.stringify(data.user) + "</p>";
                    
                    // Test /api/me
                    const meResponse = await fetch("/api/me", { credentials: "include" });
                    const meData = await meResponse.json();
                    result.innerHTML += "<p>/api/me response: " + JSON.stringify(meData) + "</p>";
                } else {
                    result.innerHTML += "<p>‚ùå Login failed: " + JSON.stringify(data) + "</p>";
                }
                
            } catch (error) {
                result.innerHTML += "<p>‚ùå Error: " + error.message + "</p>";
            }
        }
    </script>
</body>
</html>